var(ystar)
a1*a2*b
coef(lm(ystar ~ astar))
n <- 10^5
b <- 2
rho_a1 <- 0.9
rho_a2 <- 0.8
sigma_A <- 2
sigma_Y <- 10
sigma_astar <- 2.2
sigma_ystar <- 11
a1 <- rho_a1*sigma_astar/sigma_A # to astar
a2 <- rho_a2*sigma_ystar/sigma_Y # to ystar
A <- rnorm(n, sd=sigma_A)
R2_Y <- (b*sigma_A)^2/(sigma_Y^2)
Y <- b*A + sqrt(1-R2_Y)*rnorm(n, sd=sigma_Y)
R2_astar <- (a1*sigma_A)^2/((a1*sigma_A)^2 + sigma_astar^2)
astar <- a1*A + sqrt(1-R2_astar)*rnorm(n, sd=sigma_astar)
R2_ystar <- (a2*sigma_Y)^2/((a2*sigma_Y)^2 + sigma_ystar^2)
ystar <- a2*Y + sqrt(1-R2_ystar)*rnorm(n, sd=sigma_ystar)
sd(A)
sd(Y)
sd(astar)
sd(ystar)
cor(A, astar)
cor(Y, ystar)
a1*a2*b
a1*a2*b*sigma_A^2/sigma_astar/sigma_ystar
coef(lm(ystar ~ astar))
n <- 10^6
b <- 0.6
a1 <- 0.9
a2 <- 0.8
A <- rnorm(n)
Y <- b*A + sqrt(1 - b^2)*rnorm(n)
astar <- a1*A + sqrt(1 - a1^2)*rnorm(n)
ystar <- a2*Y + sqrt(1 - a2^2)*rnorm(n)
var(A)
var(Y)
var(astar)
var(ystar)
a1*a2*b
coef(lm(ystar ~ astar))
n <- 10^5
b <- 2
rho_a1 <- 0.9
rho_a2 <- 0.8
sigma_A <- 2 # total variation in A
sigma_Y <- 10 # total variation in Y
sigma_astar <- 2.2
sigma_ystar <- 11
a1 <- rho_a1*sigma_astar/sigma_A # to astar
a2 <- rho_a2*sigma_ystar/sigma_Y # to ystar
A <- rnorm(n, sd=sigma_A)
R2_Y <- (b*sigma_A)^2/sigma_Y^2
Y <- b*A + sqrt(1-R2_Y)*rnorm(n, sd=sigma_Y)
R2_astar <- (a1*sigma_A)^2/sigma_astar^2
astar <- a1*A + sqrt(1-R2_astar)*rnorm(n, sd=sigma_astar)
R2_ystar <- (a2*sigma_Y)^2/sigma_ystar^2
ystar <- a2*Y + sqrt(1-R2_ystar)*rnorm(n, sd=sigma_ystar)
sd(A)
sd(Y)
sd(astar)
sd(ystar)
cor(A, astar)
cor(Y, ystar)
a1*a2*b
a1*a2*b*sigma_A^2/sigma_astar/sigma_ystar
coef(lm(ystar ~ astar))
n <- 10^6
b <- 0.6
a1 <- 0.9
a2 <- 0.8
A <- rnorm(n)
Y <- b*A + sqrt(1 - b^2)*rnorm(n)
astar <- a1*A + sqrt(1 - a1^2)*rnorm(n)
ystar <- a2*Y + sqrt(1 - a2^2)*rnorm(n)
var(A)
var(Y)
var(astar)
var(ystar)
a1*a2*b
coef(lm(ystar ~ astar))
n <- 10^5
b <- 2
rho_a1 <- 0.9
rho_a2 <- 0.8
sigma_A <- 2 # total variation in A
sigma_Y <- 10 # total variation in Y
sigma_astar <- 2.2
sigma_ystar <- 11
a1 <- rho_a1*sigma_astar/sigma_A # to astar
a2 <- rho_a2*sigma_ystar/sigma_Y # to ystar
A <- rnorm(n, sd=sigma_A)
R2_Y <- (b*sigma_A)^2/sigma_Y^2
Y <- b*A + sqrt(1-R2_Y)*rnorm(n, sd=sigma_Y)
R2_astar <- (a1*sigma_A)^2/sigma_astar^2
astar <- a1*A + sqrt(1-R2_astar)*rnorm(n, sd=sigma_astar)
R2_ystar <- (a2*sigma_Y)^2/sigma_ystar^2
ystar <- a2*Y + sqrt(1-R2_ystar)*rnorm(n, sd=sigma_ystar)
sd(A)
sd(Y)
sd(astar)
sd(ystar)
cor(A, astar)
cor(Y, ystar)
a1*a2*b
a1*a2*b*sigma_A^2/sigma_astar/sigma_ystar
a1*a2*b*rho_a1*rho_a2
coef(lm(ystar ~ astar))
n <- 10^6
b <- 0.6
a1 <- 0.9
a2 <- 0.8
A <- rnorm(n)
Y <- b*A + sqrt(1 - b^2)*rnorm(n)
astar <- a1*A + sqrt(1 - a1^2)*rnorm(n)
ystar <- a2*Y + sqrt(1 - a2^2)*rnorm(n)
var(A)
var(Y)
var(astar)
var(ystar)
a1*a2*b
coef(lm(ystar ~ astar))
n <- 10^5
b <- 2
rho_a1 <- 0.9
rho_a2 <- 0.8
sigma_A <- 2 # total variation in A
sigma_Y <- 10 # total variation in Y
sigma_astar <- 2.2
sigma_ystar <- 11
a1 <- rho_a1*sigma_astar/sigma_A # to astar
a2 <- rho_a2*sigma_ystar/sigma_Y # to ystar
A <- rnorm(n, sd=sigma_A)
R2_Y <- (b*sigma_A)^2/sigma_Y^2
Y <- b*A + sqrt(1-R2_Y)*rnorm(n, sd=sigma_Y)
R2_astar <- (a1*sigma_A)^2/sigma_astar^2
astar <- a1*A + sqrt(1-R2_astar)*rnorm(n, sd=sigma_astar)
R2_ystar <- (a2*sigma_Y)^2/sigma_ystar^2
ystar <- a2*Y + sqrt(1-R2_ystar)*rnorm(n, sd=sigma_ystar)
sd(A)
sd(Y)
sd(astar)
sd(ystar)
cor(A, astar)
cor(Y, ystar)
a1*a2*b
a1*a2*b*sigma_A^2/sigma_astar/sigma_ystar
a1*a2*b*rho_a1*rho_a2
coef(lm(ystar ~ astar))
n <- 10^6
b <- 0.6
a1 <- 0.9
a2 <- 0.8
A <- rnorm(n)
Y <- b*A + sqrt(1 - b^2)*rnorm(n)
astar <- a1*A + sqrt(1 - a1^2)*rnorm(n)
ystar <- a2*Y + sqrt(1 - a2^2)*rnorm(n)
var(A)
var(Y)
var(astar)
var(ystar)
a1*a2*b
coef(lm(ystar ~ astar))
n <- 10^5
b <- 2
rho_a1 <- 0.9
rho_a2 <- 0.8
sigma_A <- 2 # total variation in A
sigma_Y <- 10 # total variation in Y
sigma_astar <- 2.2
sigma_ystar <- 11
a1 <- rho_a1*sigma_astar/sigma_A # to astar
a2 <- rho_a2*sigma_ystar/sigma_Y # to ystar
A <- rnorm(n, sd=sigma_A)
R2_Y <- (b*sigma_A)^2/sigma_Y^2
Y <- b*A + sqrt(1-R2_Y)*rnorm(n, sd=sigma_Y)
R2_astar <- (a1*sigma_A)^2/sigma_astar^2
astar <- a1*A + sqrt(1-R2_astar)*rnorm(n, sd=sigma_astar)
R2_ystar <- (a2*sigma_Y)^2/sigma_ystar^2
ystar <- a2*Y + sqrt(1-R2_ystar)*rnorm(n, sd=sigma_ystar)
sd(A)
sd(Y)
sd(astar)
sd(ystar)
cor(A, astar)
cor(Y, ystar)
a1*a2*b
a1*a2*b*sigma_A^2/sigma_astar/sigma_ystar
a1*a2*b*sigma_ystar/sigma_astar
coef(lm(ystar ~ astar))
n <- 10^6
b <- 0.6
a1 <- 0.9
a2 <- 0.8
A <- rnorm(n)
Y <- b*A + sqrt(1 - b^2)*rnorm(n)
astar <- a1*A + sqrt(1 - a1^2)*rnorm(n)
ystar <- a2*Y + sqrt(1 - a2^2)*rnorm(n)
var(A)
var(Y)
var(astar)
var(ystar)
a1*a2*b
coef(lm(ystar ~ astar))
n <- 10^5
b <- 2
rho_a1 <- 0.9
rho_a2 <- 0.8
sigma_A <- 2 # total variation in A
sigma_Y <- 10 # total variation in Y
sigma_astar <- 2.2
sigma_ystar <- 11
a1 <- rho_a1*sigma_astar/sigma_A # to astar
a2 <- rho_a2*sigma_ystar/sigma_Y # to ystar
A <- rnorm(n, sd=sigma_A)
R2_Y <- (b*sigma_A)^2/sigma_Y^2
Y <- b*A + sqrt(1-R2_Y)*rnorm(n, sd=sigma_Y)
R2_astar <- (a1*sigma_A)^2/sigma_astar^2
astar <- a1*A + sqrt(1-R2_astar)*rnorm(n, sd=sigma_astar)
R2_ystar <- (a2*sigma_Y)^2/sigma_ystar^2
ystar <- a2*Y + sqrt(1-R2_ystar)*rnorm(n, sd=sigma_ystar)
sd(A)
sd(Y)
sd(astar)
sd(ystar)
cor(A, astar)
cor(Y, ystar)
a1*a2*b
a1*a2*b*sigma_A^2/sigma_astar/sigma_ystar
a1*a2*b*sigma_ystar/sigma_astar
a1*a2*b*sigma_astar/sigma_ystar
coef(lm(ystar ~ astar))
n <- 10^6
b <- 0.6
a1 <- 0.9
a2 <- 0.8
A <- rnorm(n)
Y <- b*A + sqrt(1 - b^2)*rnorm(n)
astar <- a1*A + sqrt(1 - a1^2)*rnorm(n)
ystar <- a2*Y + sqrt(1 - a2^2)*rnorm(n)
var(A)
var(Y)
var(astar)
var(ystar)
a1*a2*b
coef(lm(ystar ~ astar))
n <- 10^5
b <- 2
rho_a1 <- 0.9
rho_a2 <- 0.8
sigma_A <- 2 # total variation in A
sigma_Y <- 10 # total variation in Y
sigma_astar <- 2.2
sigma_ystar <- 11
a1 <- rho_a1*sigma_astar/sigma_A # to astar
a2 <- rho_a2*sigma_ystar/sigma_Y # to ystar
A <- rnorm(n, sd=sigma_A)
R2_Y <- (b*sigma_A)^2/sigma_Y^2
Y <- b*A + sqrt(1-R2_Y)*rnorm(n, sd=sigma_Y)
R2_astar <- (a1*sigma_A)^2/sigma_astar^2
astar <- a1*A + sqrt(1-R2_astar)*rnorm(n, sd=sigma_astar)
R2_ystar <- (a2*sigma_Y)^2/sigma_ystar^2
ystar <- a2*Y + sqrt(1-R2_ystar)*rnorm(n, sd=sigma_ystar)
sd(A)
sd(Y)
sd(astar)
sd(ystar)
cor(A, astar)
cor(Y, ystar)
a1*a2*b
a1*a2*b*sigma_astar*sigma_ystar/sigma_A^2
a1*a2*b*sigma_ystar/sigma_astar
coef(lm(ystar ~ astar))
coef(lm(ystar ~ astar))
a2*b
a2*sigma_Y*b*sigma_A
coef(lm(ystar ~ Y))
a2
coef(lm(ystar ~ a))
coef(lm(ystar ~ A))
a2*b
coef(lm(ystar ~ astar))
a1*a2*b
coef(lm(astar ~ A))
a1
n <- 10^6
b <- 0.6
a1 <- 0.9
a2 <- 0.8
A <- rnorm(n)
Y <- b*A + sqrt(1 - b^2)*rnorm(n)
astar <- a1*A + sqrt(1 - a1^2)*rnorm(n)
ystar <- a2*Y + sqrt(1 - a2^2)*rnorm(n)
var(A)
var(Y)
var(astar)
var(ystar)
a1*a2*b
coef(lm(ystar ~ astar))
cor(ystar ~ astar)
n <- 10^6
b <- 0.6
a1 <- 0.9
a2 <- 0.8
A <- rnorm(n)
Y <- b*A + sqrt(1 - b^2)*rnorm(n)
astar <- a1*A + sqrt(1 - a1^2)*rnorm(n)
ystar <- a2*Y + sqrt(1 - a2^2)*rnorm(n)
var(A)
var(Y)
var(astar)
var(ystar)
a1*a2*b
coef(lm(ystar ~ astar))
cor(ystar, astar)
n <- 10^5
b <- 2
rho_a1 <- 0.9
rho_a2 <- 0.8
sigma_A <- 2 # total variation in A
sigma_Y <- 10 # total variation in Y
sigma_astar <- 2.2 # total variation
sigma_ystar <- 11 # total variation
a1 <- rho_a1*sigma_astar/sigma_A # to astar
a2 <- rho_a2*sigma_ystar/sigma_Y # to ystar
A <- rnorm(n, sd=sigma_A)
R2_Y <- (b*sigma_A)^2/sigma_Y^2
Y <- b*A + sqrt(1-R2_Y)*rnorm(n, sd=sigma_Y)
R2_astar <- (a1*sigma_A)^2/sigma_astar^2
astar <- a1*A + sqrt(1-R2_astar)*rnorm(n, sd=sigma_astar)
R2_ystar <- (a2*sigma_Y)^2/sigma_ystar^2
ystar <- a2*Y + sqrt(1-R2_ystar)*rnorm(n, sd=sigma_ystar)
coef(lm(ystar ~ astar))
n <- 10^6
b <- 0.6
a1 <- 0.9
a2 <- 0.8
A <- rnorm(n)
Y <- b*A + sqrt(1 - b^2)*rnorm(n)
astar <- a1*A + sqrt(1 - a1^2)*rnorm(n)
ystar <- a2*Y + sqrt(1 - a2^2)*rnorm(n)
var(A)
var(Y)
var(astar)
var(ystar)
a1*a2*b
coef(lm(ystar ~ astar))
cor(ystar, astar)
n <- 10^5
rho_a1 <- 0.9
rho_a2 <- 0.8
rho_b <- 0.6
sigma_A <- 2 # total variation in A
sigma_Y <- 10 # total variation in Y
sigma_astar <- 2.2 # total variation
sigma_ystar <- 11 # total variation
a1 <- rho_a1*sigma_astar/sigma_A # to astar
a2 <- rho_a2*sigma_ystar/sigma_Y # to ystar
b <- rho_b*sigma_Y/sigma_A
A <- rnorm(n, sd=sigma_A)
R2_Y <- (b*sigma_A)^2/sigma_Y^2
Y <- b*A + sqrt(1-R2_Y)*rnorm(n, sd=sigma_Y)
R2_astar <- (a1*sigma_A)^2/sigma_astar^2
astar <- a1*A + sqrt(1-R2_astar)*rnorm(n, sd=sigma_astar)
R2_ystar <- (a2*sigma_Y)^2/sigma_ystar^2
ystar <- a2*Y + sqrt(1-R2_ystar)*rnorm(n, sd=sigma_ystar)
coef(lm(ystar ~ astar))
b
coef(lm(ystar ~ Y))
a2
coef(lm(ystar ~ A))
a2*b
coef(lm(astar ~ A))
a1
sd(A)
sd(Y)
sd(astar)
sd(ystar)
cor(A, astar)
cor(Y, ystar)
coef(lm(ystar ~ astar))
rho_a1*rho_a2*rho*a3*sigma_ystar/sigma_astar
coef(lm(ystar ~ astar))
rho_a1*rho_a2*rho_b*sigma_ystar/sigma_astar
coef(lm(ystar ~ astar))
rho_a1*rho_a2*rho_b*sigma_ystar/sigma_astar
rho_a1*sigma_A/sigma_Y*rho_a2*sigma_ystar/sigma_astar*b
n <- 10^6
b <- 0.6
a1 <- 0.9
a2 <- 0.8
A <- rnorm(n)
Y <- b*A + sqrt(1 - b^2)*rnorm(n)
astar <- a1*A + sqrt(1 - a1^2)*rnorm(n)
ystar <- a2*Y + sqrt(1 - a2^2)*rnorm(n)
var(A)
var(Y)
var(astar)
var(ystar)
a1*a2*b
coef(lm(ystar ~ astar))
cor(ystar, astar)
n <- 10^5
rho_a1 <- 0.9
rho_a2 <- 0.8
rho_b <- 0.6
sigma_A <- 2 # total variation in A
sigma_Y <- 10 # total variation in Y
sigma_astar <- 2.2 # total variation
sigma_ystar <- 100 # total variation
a1 <- rho_a1*sigma_astar/sigma_A # to astar
a2 <- rho_a2*sigma_ystar/sigma_Y # to ystar
b <- rho_b*sigma_Y/sigma_A
A <- rnorm(n, sd=sigma_A)
R2_Y <- (b*sigma_A)^2/sigma_Y^2
Y <- b*A + sqrt(1-R2_Y)*rnorm(n, sd=sigma_Y)
R2_astar <- (a1*sigma_A)^2/sigma_astar^2
astar <- a1*A + sqrt(1-R2_astar)*rnorm(n, sd=sigma_astar)
R2_ystar <- (a2*sigma_Y)^2/sigma_ystar^2
ystar <- a2*Y + sqrt(1-R2_ystar)*rnorm(n, sd=sigma_ystar)
coef(lm(ystar ~ astar))
coef(lm(ystar ~ Y))
a2
coef(lm(ystar ~ A))
a2*b
coef(lm(astar ~ A))
a1
coef(lm(ystar ~ astar))
rho_a1*rho_a2*rho_b*sigma_ystar/sigma_astar
rho_a1*sigma_A/sigma_Y*rho_a2*sigma_ystar/sigma_astar*b
coef(lm(ystar ~ astar))
rho_a1*rho_a2*rho_b*sigma_ystar/sigma_astar
rho_a1*sigma_A/sigma_Y*rho_a2*sigma_ystar/sigma_astar*b
b
n <- 10^6
b <- 0.6
a1 <- 0.9
a2 <- 0.8
A <- rnorm(n)
Y <- b*A + sqrt(1 - b^2)*rnorm(n)
astar <- a1*A + sqrt(1 - a1^2)*rnorm(n)
ystar <- a2*Y + sqrt(1 - a2^2)*rnorm(n)
var(A)
var(Y)
var(astar)
var(ystar)
a1*a2*b
coef(lm(ystar ~ astar))
cor(ystar, astar)
n <- 10^5
rho_a1 <- 0.9
rho_a2 <- 0.8
rho_b <- 0.6
sigma_A <- 2 # total variation in A
sigma_Y <- 10 # total variation in Y
sigma_astar <- 2.2 # total variation
sigma_ystar <- 10 # total variation
a1 <- rho_a1*sigma_astar/sigma_A # to astar
a2 <- rho_a2*sigma_ystar/sigma_Y # to ystar
b <- rho_b*sigma_Y/sigma_A
A <- rnorm(n, sd=sigma_A)
R2_Y <- (b*sigma_A)^2/sigma_Y^2
Y <- b*A + sqrt(1-R2_Y)*rnorm(n, sd=sigma_Y)
R2_astar <- (a1*sigma_A)^2/sigma_astar^2
astar <- a1*A + sqrt(1-R2_astar)*rnorm(n, sd=sigma_astar)
R2_ystar <- (a2*sigma_Y)^2/sigma_ystar^2
ystar <- a2*Y + sqrt(1-R2_ystar)*rnorm(n, sd=sigma_ystar)
coef(lm(ystar ~ astar))
coef(lm(ystar ~ astar))
rho_a1*rho_a2*rho_b*sigma_ystar/sigma_astar
rho_a1*sigma_A/sigma_Y*rho_a2*sigma_ystar/sigma_astar*b
b
n <- 10^6
b <- 0.6
a1 <- 0.9
a2 <- 0.8
A <- rnorm(n)
Y <- b*A + sqrt(1 - b^2)*rnorm(n)
astar <- a1*A + sqrt(1 - a1^2)*rnorm(n)
ystar <- a2*Y + sqrt(1 - a2^2)*rnorm(n)
var(A)
var(Y)
var(astar)
var(ystar)
a1*a2*b
coef(lm(ystar ~ astar))
cor(ystar, astar)
n <- 10^5
rho_a1 <- 0.9
rho_a2 <- 0.8
rho_b <- 0.6
sigma_A <- 2 # total variation in A
sigma_Y <- 10 # total variation in Y
sigma_astar <- 2.2 # total variation
sigma_ystar <- 20 # total variation
a1 <- rho_a1*sigma_astar/sigma_A # to astar
a2 <- rho_a2*sigma_ystar/sigma_Y # to ystar
b <- rho_b*sigma_Y/sigma_A
A <- rnorm(n, sd=sigma_A)
R2_Y <- (b*sigma_A)^2/sigma_Y^2
Y <- b*A + sqrt(1-R2_Y)*rnorm(n, sd=sigma_Y)
R2_astar <- (a1*sigma_A)^2/sigma_astar^2
astar <- a1*A + sqrt(1-R2_astar)*rnorm(n, sd=sigma_astar)
R2_ystar <- (a2*sigma_Y)^2/sigma_ystar^2
ystar <- a2*Y + sqrt(1-R2_ystar)*rnorm(n, sd=sigma_ystar)
coef(lm(ystar ~ astar))
coef(lm(ystar ~ astar))
rho_a1*rho_a2*rho_b*sigma_ystar/sigma_astar
rho_a1*sigma_A/sigma_Y*rho_a2*sigma_ystar/sigma_astar*b
b
