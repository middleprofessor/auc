"0","auc <- function(x, y, method=""auc""){"
"0","  # method = ""auc"", auc computed using trapezoidal calc"
"0","  # method = ""iauc"" is an incremental AUC of Le Floch"
"0","  # method = ""pos.iauc"" is a ""positive"" incremental AUC of Le Floch but not Wolever"
"0","  # method = ""pb.auc"" is AUC of post-time0 values"
"0","  if(method==""iauc""){y <- y - y[1]}"
"0","  if(method==""pos.iauc""){y[y < 0] <- 0}"
"0","  if(method==""pb.auc""){"
"0","    x <- x[-1]"
"0","    y <- y[-1]"
"0","  }"
"0","  n <- length(x)"
"0","  area <- 0"
"0","  for(i in 2:n){"
"0","    area <- area + (x[i] - x[i-1])*(y[i-1] + y[i])"
"0","  }"
"0","  area/2"
"0","}"
"0","plot_all_curves <- function(data){"
"0","  gg <- ggplot(data=data, "
"0","         aes(x = time,"
"0","             y = glucose,"
"0","             color = treatment)) +"
"0","    geom_point() +"
"0","    geom_line(aes(group = id))"
"0"," return(gg)"
"0","}"
