"0","jco_pal1 <- pal_jco()(6)"
"0","group_colors <- c(rep(jco_pal[c(2,5,4,6)], each=3))[1:length(method_list)]"
"0","group_shapes <- c(rep(c(15, 16, 17), 4))[1:length(method_list)]"
"0","sim2_long[, d_baseline_std := abs(d_baseline)/emp.sigma]"
"0","sim2_long[, logit_p := ifelse(is.infinite(logit(p)), NA, logit(p))]"
"0","plot_data <- data.table(NULL)"
"0","new_d_baseline <- seq(0, 1.5, by=0.1) # uniform values of d_baseline_std for prediction"
"0","new_data <- data.table(d_baseline_std = new_d_baseline)"
"0","for(model_i in levels(sim2_long$R_model)){"
"0","  for(method_i in method_list){"
"0","    m1 <- glm(significant ~ d_baseline_std, "
"0","              family = binomial(link=""logit""), "
"0","              data=sim2_long[method==method_i & R_model==model_i])"
"0","    prob.m1 <- predict(m1, new_data, type=""response"")"
"0","    plot_data <- rbind(plot_data, data.table(method = method_i,"
"0","                                             R_model = model_i,"
"0","                                             d_baseline_std = new_d_baseline, "
"0","                                             prob.m1=prob.m1))"
"0","  }"
"0","}"
"0","plot_data[, method := factor(method, method_list)]"
"0","gg1 <- ggplot(data=plot_data,"
"0","              aes(x=d_baseline_std, y=prob.m1, color=method, shape=method)) +"
"0","  geom_hline(yintercept = 0.05, linetype = ""dashed"", alpha=0.5) +"
"0","  geom_point() +"
"0","  geom_line() +"
"0","  scale_color_manual(values = group_colors) +"
"0","  scale_shape_manual(values = group_shapes) +"
"0","  ylab(""Probability of p < 0.05"") +"
"0","  xlab(""Difference at Time0 (in standard deviation units)"") +"
"0","  theme_pubr() +"
"0","  theme(legend.position=""top"") +"
"0","  guides(col = guide_legend(ncol = 4)) +"
"0","  facet_grid(.~R_model, labeller = ""label_both"") +"
"0","  NULL"
"0","gg1"
